# https://github.com/voodootikigod/node-serialport/blob/master/serialport.js#L24-L39
#

xpars =
  raw: (emitter, buffer) ->
    emitter.emit "data", buffer
    return

  readline: (delimiter) ->
    if (typeof delimiter == "undefined" or delimiter == null)
      delimiter = '\r'
    #Delimiter buffer saved in closure
    data = "";
    (emitter, buffer) ->
      #Collect data
      data += buffer.toString()
      #Split collected data by delimiter
      parts = data.split(delimiter)
      data = parts.pop();
      emitter.emit 'data', part for part in parts
      return

module.exports = xpars;